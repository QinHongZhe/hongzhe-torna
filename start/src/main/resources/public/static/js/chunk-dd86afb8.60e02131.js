(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dd86afb8"],{"49ea":function(e,t,o){"use strict";o("d03d")},"60bf":function(e,t,o){"use strict";o("ef8e")},"707c":function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"app-container"},[o("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[o("el-tab-pane",{attrs:{name:"Doc"}},[o("span",{attrs:{slot:"label"},slot:"label"},[o("i",{staticClass:"el-icon-document"}),e._v(" 文档管理")]),e._v(" "),o("module",{attrs:{"project-id":e.projectIdDoc}})],1),e._v(" "),o("el-tab-pane",{attrs:{name:"Info"}},[o("span",{attrs:{slot:"label"},slot:"label"},[o("i",{staticClass:"el-icon-info"}),e._v(" 项目信息")]),e._v(" "),o("project-info",{attrs:{"project-id":e.projectIdInfo}})],1),e._v(" "),o("el-tab-pane",{attrs:{name:"Member"}},[o("span",{attrs:{slot:"label"},slot:"label"},[o("i",{staticClass:"el-icon-user"}),e._v(" 项目成员")]),e._v(" "),o("project-member",{attrs:{"project-id":e.projectIdMember}})],1)],1)],1)},r=[],l=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-container",[o("el-aside",{attrs:{width:"200px"}},[o("ul",{staticClass:"module-menu el-menu"},[o("li",{staticClass:"el-submenu is-active is-opened"},[o("div",{staticClass:"el-submenu__title",staticStyle:{"padding-left":"20px"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("\n              模块列表\n              "),o("el-dropdown",{staticStyle:{"margin-bottom":"5px",float:"right"},on:{command:e.handleCommand}},[o("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-circle-plus-outline"}}),e._v(" "),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-dropdown-item",{attrs:{icon:"el-icon-box",command:e.onModuleAdd}},[e._v("新建模块")]),e._v(" "),o("el-dropdown-item",{attrs:{icon:"el-icon-download",divided:"",command:e.onImportSwagger}},[e._v("导入Swagger文档")])],1)],1)],1)]),e._v(" "),o("ul",{staticClass:"el-menu el-menu--inline",attrs:{role:"menu"}},e._l(e.moduleData,(function(t){return o("li",{key:t.id,staticClass:"el-menu-item",class:{"is-active":e.isActive(t)},staticStyle:{"padding-left":"40px"},on:{click:function(o){return e.onModuleSelect(t)}}},[o("span",[e._v("\n                "+e._s(t.name)+"\n              ")]),e._v(" "),o("el-tooltip",{attrs:{effect:"dark",content:"同步Swagger文档",placement:"top"}},[o("el-button",{directives:[{name:"show",rawName:"v-show",value:e.module.id===t.id&&1===t.type,expression:"module.id === item.id && item.type === 1"}],attrs:{loading:e.refreshSwaggerLoading,type:"text",icon:"el-icon-refresh"},on:{click:function(o){return o.stopPropagation(),e.onRefreshSwagger(t)}}})],1)],1)})),0)])])]),e._v(" "),o("el-main",{staticStyle:{"padding-top":"0"}},[o("doc-info",{ref:"docInfo",attrs:{"module-id":e.module.id}})],1)],1),e._v(" "),o("import-swagger-dialog",{ref:"importSwaggerDlg",attrs:{"project-id":e.projectId,success:e.reload}})],1)},n=[],i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[o("el-tab-pane",{attrs:{label:"接口列表",name:"DocList"}},[o("doc-table",{ref:"docTable",attrs:{"module-id":e.moduleIdDocList}})],1),e._v(" "),o("el-tab-pane",{attrs:{label:"模块配置",name:"ModuleSetting"}},[o("module-setting",{attrs:{"module-id":e.moduleIdModuleSetting}})],1)],1)},s=[],d=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticStyle:{"margin-bottom":"10px"}},[o("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleCommand}},[o("el-button",{attrs:{type:"primary",size:"mini"}},[e._v("\n        新建接口 "),o("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-dropdown-item",{attrs:{icon:"el-icon-document",command:e.onDocNew}},[e._v("新建接口")]),e._v(" "),o("el-dropdown-item",{attrs:{icon:"el-icon-folder",command:e.onFolderAdd}},[e._v("新建分类")])],1)],1),e._v(" "),o("el-input",{staticStyle:{width:"300px",float:"right"},attrs:{"prefix-icon":"el-icon-search",clearable:"",size:"mini",placeholder:"过滤: 支持名称、路径"},model:{value:e.tableSearch,callback:function(t){e.tableSearch=t},expression:"tableSearch"}})],1),e._v(" "),o("el-table",{attrs:{data:e.tableData,"row-key":"id",border:"","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"},"cell-style":e.cellStyleSmall(),"header-cell-style":e.headCellStyleSmall(),"row-class-name":e.tableRowClassName}},[o("el-table-column",{attrs:{prop:"name",label:"文档名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"url",label:"请求路径"}}),e._v(" "),o("el-table-column",{attrs:{label:"文档内容",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isDoc(t.row)?o("el-button",{attrs:{type:"text",icon:"el-icon-view"},on:{click:function(o){return e.onDocView(t.row)}}},[e._v("预览")]):e._e()]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"gmtCreate",label:"添加时间",width:"160"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isFolder(t.row)?o("el-link",{attrs:{type:"primary"},on:{click:function(o){return e.onDocAdd(t.row)}}},[e._v("添加接口")]):e._e(),e._v(" "),o("el-link",{attrs:{type:"primary"},on:{click:function(o){return e.onDocUpdate(t.row)}}},[e._v("修改")]),e._v(" "),o("el-popconfirm",{attrs:{title:"确定要删除 "+t.row.name+" 吗？"},on:{onConfirm:function(o){return e.onDocRemove(t.row)}}},[0===t.row.children.length?o("el-link",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[e._v("删除")]):e._e()],1)]}}])})],1),e._v(" "),o("el-dialog",{attrs:{title:"预览",visible:e.viewDialogVisible,width:"70%"},on:{"update:visible":function(t){e.viewDialogVisible=t}}},[o("doc-view",{directives:[{name:"show",rawName:"v-show",value:e.viewDocId,expression:"viewDocId"}],attrs:{"doc-id":e.viewDocId}})],1)],1)},c=[],m=(o("7f7f"),o("cbc6")),u={name:"DocTable",components:{DocView:m["a"]},props:{moduleId:{type:String,default:""}},data:function(){return{tableData:[],tableSearch:"",viewDialogVisible:!1,viewDocId:""}},watch:{moduleId:function(e){this.loadTable(e)}},methods:{reload:function(){this.loadTable(this.moduleId)},loadTable:function(e){this.get("/doc/list",{moduleId:e},(function(e){var t=e.data;this.tableData=this.convertTree(t)}))},onFolderUpdate:function(e){var t=this;this.$prompt("请输入分类名称","修改分类",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:e.name,inputPattern:/^.{1,64}$/,inputErrorMessage:"不能为空且长度在64以内"}).then((function(o){var a=o.value,r={id:e.id,name:a};t.post("/doc/folder/update",r,(function(){t.tipSuccess("修改成功"),t.reload()}))})).catch((function(){}))},onDocNew:function(){this.goRoute("/doc/new/".concat(this.moduleId))},onFolderAdd:function(){var e=this;this.$prompt("请输入分类名称","新建分类",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^.{1,64}$/,inputErrorMessage:"不能为空且长度在64以内"}).then((function(t){var o=t.value,a={name:o,moduleId:e.moduleId};e.post("/doc/folder/add",a,(function(){e.tipSuccess("创建成功"),e.reload()}))})).catch((function(){}))},isDoc:function(e){return!this.isFolder(e)},isFolder:function(e){return 1===e.isFolder},tableRowClassName:function(e){var t=e.row;e.index;if(t.hidden=!1,0===this.tableSearch.length)return"";var o=this.tableSearch.toLowerCase(),a=t.name&&t.name.toLowerCase().indexOf(o)>-1||t.url&&t.url.toLowerCase().indexOf(o)>-1;return a?"":(t.hidden=!0,"hidden-row")},onDocRemove:function(e){var t=this,o={id:e.id};this.post("/doc/delete",o,(function(){t.tipSuccess("删除成功"),t.reload()}))},onDocAdd:function(e){this.goRoute("/doc/new/".concat(this.moduleId,"/").concat(e.id))},onDocUpdate:function(e){e.isFolder?this.onFolderUpdate(e):this.goRoute("/doc/edit/".concat(this.moduleId,"/").concat(e.id))},onDocView:function(e){var t=this;this.viewDialogVisible=!0,this.$nextTick((function(){t.viewDocId=e.id}))}}},p=u,f=o("2877"),h=Object(f["a"])(p,d,c,!1,null,null,null),v=h.exports,g=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("h2",[e._v(e._s(e.settings.moduleVO.name)+"配置")]),e._v(" "),o("h4",[e._v("全局Headers")]),e._v(" "),o("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary",size:"mini"},on:{click:e.onHeaderAdd}},[e._v("添加Header")]),e._v(" "),o("el-table",{attrs:{data:e.settings.globalHeaders,border:"","header-cell-style":e.cellStyleSmall(),"cell-style":e.cellStyleSmall()}},[o("el-table-column",{attrs:{label:"Name",prop:"configKey",width:"300px"}}),e._v(" "),o("el-table-column",{attrs:{label:"Value",prop:"configValue"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(o){return e.onHeaderUpdate(t.row)}}},[e._v("修改")]),e._v(" "),o("el-popconfirm",{attrs:{title:"确定要删除 "+t.row.configKey+" 吗？"},on:{onConfirm:function(o){return e.onHeaderDelete(t.row)}}},[o("el-button",{attrs:{slot:"reference",type:"text",size:"mini"},slot:"reference"},[e._v("删除")])],1)]}}])})],1),e._v(" "),o("h4",[e._v("调试Host")]),e._v(" "),o("el-alert",{staticStyle:{"margin-bottom":"10px"},attrs:{title:"调试页面请求Host",closable:!1}}),e._v(" "),o("el-form",{ref:"debugHostRef",attrs:{model:e.settings,size:"mini"}},[o("el-form-item",{attrs:{prop:"debugHost"}},[o("el-input",{attrs:{placeholder:"如：http://10.0.10.11:8080"},model:{value:e.settings.debugHost,callback:function(t){e.$set(e.settings,"debugHost",t)},expression:"settings.debugHost"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.onSaveDebugHost}},[e._v("保存")])],1)],1),e._v(" "),1===e.settings.moduleVO.type?o("div",[o("h4",[e._v("Swagger多个Method重复，只显示")]),e._v(" "),o("el-form",{ref:"allowMethodsRef",attrs:{model:e.settings,size:"mini"}},[o("el-form-item",{attrs:{prop:"allowMethods"}},[o("el-select",{on:{change:e.onSaveAllowMethods},model:{value:e.settings.allowMethod,callback:function(t){e.$set(e.settings,"allowMethod",t)},expression:"settings.allowMethod"}},e._l(e.allMethods,(function(t){return o("el-option",{key:t,attrs:{label:t,value:t}},[e._v("\n            "+e._s(t)+"\n          ")])})),1)],1)],1)],1):e._e(),e._v(" "),o("el-dialog",{attrs:{title:e.dialogHeaderTitle,visible:e.dialogHeaderVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogHeaderVisible=t},close:function(t){return e.resetForm("dialogHeaderForm")}}},[o("el-form",{ref:"dialogHeaderForm",attrs:{rules:e.dialogFormRules,model:e.dialogHeaderFormData,"label-width":"120px",size:"mini"}},[o("el-form-item",{attrs:{prop:"configKey",label:"Name"}},[o("el-input",{attrs:{placeholder:"name"},model:{value:e.dialogHeaderFormData.configKey,callback:function(t){e.$set(e.dialogHeaderFormData,"configKey",t)},expression:"dialogHeaderFormData.configKey"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"configValue",label:"Value"}},[o("el-input",{attrs:{placeholder:"value"},model:{value:e.dialogHeaderFormData.configValue,callback:function(t){e.$set(e.dialogHeaderFormData,"configValue",t)},expression:"dialogHeaderFormData.configValue"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialogHeaderVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.onDialogHeaderSave}},[e._v("保 存")])],1)],1)],1)},b=[],_={name:"ModuleSetting",props:{moduleId:{type:String,default:""}},data:function(){return{settings:{moduleVO:{name:"",type:0},globalHeaders:[],allowMethod:"POST",debugHost:""},allMethods:["GET","POST","PUT","PATCH","DELETE","OPTIONS","HEAD"],dialogHeaderVisible:!1,dialogHeaderTitle:"",dialogHeaderFormData:{id:"",moduleId:"",configKey:"",configValue:""},dialogFormRules:{configKey:[{required:!0,message:"不能为空",trigger:"blur"},{validator:function(e,t,o){t&&!/^[a-zA-Z0-9\-_]+$/.test(t)?o(new Error("格式错误，支持大小写英文、数字、-、下划线")):o()},trigger:"blur"}],configValue:[{required:!0,message:"不能为空",trigger:"blur"}]}}},watch:{moduleId:function(e){this.loadSettings(e)}},methods:{reload:function(){this.loadSettings(this.moduleId)},loadHeaders:function(){var e=this;this.get("/module/setting/globalHeader/list",{moduleId:this.moduleId},(function(t){e.settings.globalHeaders=t.data}))},loadSettings:function(e){e&&this.get("/module/setting/get",{moduleId:e},(function(e){this.settings=e.data}))},onHeaderAdd:function(){this.dialogHeaderTitle="新增Header",this.dialogHeaderVisible=!0,this.dialogHeaderFormData.id=""},onHeaderUpdate:function(e){var t=this;this.dialogHeaderTitle="修改Header",this.dialogHeaderVisible=!0,this.$nextTick((function(){Object.assign(t.dialogHeaderFormData,e)}))},onHeaderDelete:function(e){var t=this;this.post("/module/setting/globalHeader/delete",e,(function(){t.tip("删除成功"),t.loadHeaders()}))},onDialogHeaderSave:function(){var e=this;this.$refs.dialogHeaderForm.validate((function(t){if(t){var o=e.dialogHeaderFormData.id?"/module/setting/globalHeader/update":"/module/setting/globalHeader/add";e.dialogHeaderFormData.moduleId=e.moduleId,e.post(o,e.dialogHeaderFormData,(function(){e.dialogHeaderVisible=!1,e.loadHeaders()}))}}))},onSaveAllowMethods:function(){var e=this,t={moduleId:this.moduleId,method:this.settings.allowMethod};this.post("/module/setting/allowMethod/set",t,(function(){e.tipSuccess("修改成功")}))},onSaveDebugHost:function(){var e=this;this.$refs.debugHostRef.validate((function(t){if(t){var o={moduleId:e.moduleId,debugHost:e.settings.debugHost};e.post("/module/setting/debughost/set",o,(function(){e.tipSuccess("保存成功")}))}}))}}},w=_,S=Object(f["a"])(w,g,b,!1,null,null,null),D=S.exports,I={name:"DocInfo",components:{DocTable:v,ModuleSetting:D},props:{moduleId:{type:String,default:""}},data:function(){return{activeName:"DocList",moduleIdDocList:"",moduleIdModuleSetting:""}},watch:{moduleId:function(e){this.loadData(e)}},methods:{reload:function(){this.activeName="DocList",this.$refs.docTable.reload()},handleClick:function(){this.loadData(this.moduleId)},loadData:function(e){this["moduleId".concat(this.activeName)]=e}}},y=I,x=Object(f["a"])(y,i,s,!1,null,null,null),j=x.exports,C=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-dialog",{attrs:{title:"导入Swagger文档",visible:e.importJsonDlgShow},on:{"update:visible":function(t){e.importJsonDlgShow=t},close:e.onHide}},[o("el-form",{ref:"importJsonForm",attrs:{model:e.importJsonFormData,rules:e.importJsonRule,size:"mini","label-width":"100px"}},[o("el-form-item",{attrs:{label:"URL",prop:"url"}},[o("el-input",{attrs:{placeholder:"输入URL，如：http://xxx:8080/swagger/doc.json","show-word-limit":"",maxlength:"100"},model:{value:e.importJsonFormData.importUrl,callback:function(t){e.$set(e.importJsonFormData,"importUrl",t)},expression:"importJsonFormData.importUrl"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"Basic认证"}},[o("el-col",{staticStyle:{"padding-right":"10px"},attrs:{span:12}},[o("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"选填，username"},model:{value:e.importJsonFormData.basicAuthUsername,callback:function(t){e.$set(e.importJsonFormData,"basicAuthUsername",t)},expression:"importJsonFormData.basicAuthUsername"}})],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"选填，password"},model:{value:e.importJsonFormData.basicAuthPassword,callback:function(t){e.$set(e.importJsonFormData,"basicAuthPassword",t)},expression:"importJsonFormData.basicAuthPassword"}})],1)],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.importJsonDlgShow=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{loading:e.importJsonLoading,type:"primary"},on:{click:e.onImportSwaggerSave}},[e._v("导 入")])],1)],1)},F=[],k={name:"ImportSwaggerDialog",props:{projectId:{type:String,default:""},success:{type:Function,default:function(){}}},data:function(){return{importJsonDlgShow:!1,importJsonLoading:!1,importJsonFormData:{projectId:"",importUrl:"",basicAuthUsername:"",basicAuthPassword:""},importJsonRule:{url:[{required:!0,message:"不能为空",trigger:"blur"},{validator:function(e,t,o){t&&!/^http(s)?:\/\/.+$/i.test(t)?o(new Error("URL格式不正确")):o()},trigger:"blur"}]}}},methods:{show:function(){this.onImportSwagger()},onHide:function(){this.resetForm("importJsonForm")},onImportSwagger:function(){this.importJsonLoading=!1,this.importJsonDlgShow=!0},onImportSwaggerSave:function(){var e=this;this.$refs.importJsonForm.validate((function(t){t&&(e.importJsonLoading=!0,e.importJsonFormData.projectId=e.projectId,e.formatHost(e.importJsonFormData),e.post("/module/import/swagger",e.importJsonFormData,(function(t){e.importJsonLoading=!1,e.importJsonDlgShow=!1,e.tipSuccess("导入成功"),e.success&&e.success()}),(function(){e.importJsonLoading=!1})))}))}}},H=k,P=Object(f["a"])(H,C,F,!1,null,null,null),$=P.exports,A={name:"Module",components:{DocInfo:j,ImportSwaggerDialog:$},props:{projectId:{type:String,default:""}},data:function(){return{module:"",moduleData:[],refreshSwaggerLoading:!1}},watch:{projectId:function(e){this.loadModule(e)}},methods:{reload:function(){this.loadModule(this.projectId)},loadModule:function(e){e&&this.get("/module/list",{projectId:e},(function(e){this.moduleData=e.data,this.moduleData.length>0&&!this.module&&(this.module=this.moduleData[0])}))},isActive:function(e){return this.module.id===e.id},onModuleSelect:function(e){this.module=e},onModuleAdd:function(){var e=this;this.$prompt("请输入模块名称","新建模块",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^.{1,64}$/,inputErrorMessage:"不能为空且长度在64以内"}).then((function(t){var o=t.value,a={name:o,projectId:e.projectId};e.post("/module/add",a,(function(t){e.tipSuccess("创建成功"),e.module=t.data,e.reload()}))})).catch((function(){}))},onRefreshSwagger:function(e){var t=this;this.refreshSwaggerLoading=!0,this.get("/module/refresh/swagger",{moduleId:e.id},(function(){t.refreshSwaggerLoading=!1,t.tipSuccess("同步成功"),t.$refs.docInfo.reload()}),(function(){t.refreshSwaggerLoading=!1}))},onImportSwagger:function(){this.$refs.importSwaggerDlg.show()}}},T=A,M=(o("49ea"),Object(f["a"])(T,l,n,!1,null,null,null)),J=M.exports,R=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-form",{ref:"form",staticClass:"text-form",attrs:{model:e.form,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"项目名称"}},[e._v("\n      "+e._s(e.form.name)+"\n    ")]),e._v(" "),o("el-form-item",{attrs:{label:"项目描述"}},[e._v("\n      "+e._s(e.form.description)+"\n    ")]),e._v(" "),o("el-form-item",{attrs:{label:"项目组长"}},[e._v("\n      "+e._s(e.form.leader)+"\n    ")]),e._v(" "),o("el-form-item",{attrs:{label:"访问权限"}},[e._v("\n      "+e._s(1===e.form.isPrivate?"私有":"公开")+"\n    ")]),e._v(" "),o("el-form-item",{attrs:{label:"创建人"}},[e._v("\n      "+e._s(e.form.creator)+"\n    ")]),e._v(" "),o("el-form-item",{attrs:{label:"创建时间"}},[e._v("\n      "+e._s(e.form.gmtCreate)+"\n    ")]),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.onProjectUpdate}},[e._v("修改项目")]),e._v(" "),o("el-button",{attrs:{type:"danger",size:"mini"},on:{click:e.onProjectDel}},[e._v("删除项目")])],1)],1),e._v(" "),o("el-dialog",{attrs:{title:"修改项目","close-on-click-modal":!1,visible:e.projectDlgShow},on:{"update:visible":function(t){e.projectDlgShow=t}}},[o("el-form",{ref:"projectForm",staticStyle:{width:"600px"},attrs:{model:e.projectFormData,rules:e.projectRule,size:"mini","label-width":"150px"}},[o("el-form-item",{attrs:{label:"项目名称",prop:"name"}},[o("el-input",{attrs:{"show-word-limit":"",maxlength:"50"},model:{value:e.projectFormData.name,callback:function(t){e.$set(e.projectFormData,"name",t)},expression:"projectFormData.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"项目描述",prop:"description"}},[o("el-input",{attrs:{type:"textarea","show-word-limit":"",maxlength:"100"},model:{value:e.projectFormData.description,callback:function(t){e.$set(e.projectFormData,"description",t)},expression:"projectFormData.description"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"项目组长",required:""}},[o("user-select",{ref:"userSelect",attrs:{loader:e.loadSpaceMember,multiple:"",value:e.projectFormData.leaderIds}})],1),e._v(" "),o("el-form-item",{attrs:{label:"所属空间",prop:"spaceId"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.projectFormData.spaceId,callback:function(t){e.$set(e.projectFormData,"spaceId",t)},expression:"projectFormData.spaceId"}},e._l(e.spaceData,(function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}},[e._v("\n            "+e._s(t.name)+"\n          ")])})),1)],1),e._v(" "),o("el-form-item",{attrs:{label:"访问权限"}},[o("el-radio-group",{model:{value:e.projectFormData.isPrivate,callback:function(t){e.$set(e.projectFormData,"isPrivate",t)},expression:"projectFormData.isPrivate"}},[o("el-radio",{staticClass:"el-icon-lock",attrs:{label:1}},[e._v("私有")]),e._v(" "),o("el-radio",{attrs:{label:0}},[e._v("公开")])],1)],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.projectDlgShow=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.onProjectUpdateSave}},[e._v("保 存")])],1)],1)],1)},L=[],E=(o("ac6a"),o("5df3"),o("3944")),V={name:"ProjectInfo",components:{UserSelect:E["a"]},props:{projectId:{type:String,default:""}},data:function(){return{form:{id:"",name:"",leaderIds:[],leader:"",spaceId:"",description:"",isPrivate:0,creator:"",gmtCreate:""},projectDlgShow:!1,projectFormData:{name:"",description:"",spaceId:"",leaderIds:[],isPrivate:1},projectRule:{name:[{required:!0,message:"不能为空",trigger:"blur"}],spaceId:[{required:!0,message:"不能为空",trigger:"blur"}]},spaceData:[]}},watch:{projectId:function(e){this.loadInfo(e)}},mounted:function(){var e=this;this.loadSpaceData((function(t,o){e.spaceData=t}))},methods:{onProjectDel:function(){var e=this;this.confirm("确认要删除该项目吗？",(function(){e.post("/project/delete",{id:e.projectId},(function(){e.tipSuccess("删除成功"),e.goHome()}))}))},onProjectUpdate:function(){this.projectDlgShow=!0,Object.assign(this.projectFormData,this.form)},onProjectUpdateSave:function(){var e=this,t=this.$refs.userSelect.validate(),o=this.$refs.projectForm.validate();Promise.all([t,o]).then((function(t){e.projectFormData.leaderIds=e.$refs.userSelect.getValue(),e.post("/project/update",e.projectFormData,(function(t){e.projectDlgShow=!1,e.projectFormData.spaceId!==e.form.spaceId?location.reload():(e.tipSuccess("修改成功"),e.fireEvent("projectChange",(new Date).getTime()),e.loadInfo(e.projectId))}))})).catch((function(e){}))},loadInfo:function(e){var t=this;e&&this.get("/project/info",{projectId:e},(function(e){var o=e.data;o.leader=o.leaders.map((function(e){return e.realname})).join(" / "),o.leaderIds=o.leaders.map((function(e){return e.id})),t.form=o}))}}},z=V,N=Object(f["a"])(z,R,L,!1,null,null,null),O=N.exports,U=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-form",{attrs:{inline:!0,model:e.searchFormData,size:"mini"}},[o("el-form-item",{attrs:{label:"登录账号"}},[o("el-input",{staticStyle:{width:"250px"},attrs:{clearable:!0,placeholder:"登录账号"},model:{value:e.searchFormData.username,callback:function(t){e.$set(e.searchFormData,"username",t)},expression:"searchFormData.username"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"角色"}},[o("el-select",{attrs:{clearable:""},model:{value:e.searchFormData.roleCode,callback:function(t){e.$set(e.searchFormData,"roleCode",t)},expression:"searchFormData.roleCode"}},e._l(e.roleCodeConfig,(function(t){return o("el-option",{key:t.code,attrs:{value:t.code,label:t.label}},[e._v("\n            "+e._s(t.label)+"\n          ")])})),1)],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.loadTable}},[e._v("查询")])],1)],1),e._v(" "),o("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:e.onMemberAdd}},[e._v("添加成员")]),e._v(" "),o("el-table",{attrs:{data:e.pageInfo.rows,border:"","highlight-current-row":""}},[o("el-table-column",{attrs:{prop:"username",label:"成员",width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.realname+"("+t.row.username+")")+"\n        ")]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"roleCode",label:"角色",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-select",{attrs:{size:"mini"},on:{change:function(o){return e.onRoleChange(t.row)}},model:{value:t.row.roleCode,callback:function(o){e.$set(t.row,"roleCode",o)},expression:"scope.row.roleCode"}},e._l(e.roleCodeConfig,(function(t){return o("el-option",{key:t.code,attrs:{value:t.code,label:t.label}},[e._v("\n              "+e._s(t.label)+"\n            ")])})),1)]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"gmtCreate",label:"加入时间",width:"200"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-popconfirm",{attrs:{title:"确定要移除 "+t.row.realname+"("+t.row.username+") 吗？"},on:{onConfirm:function(o){return e.onMemberRemove(t.row)}}},[o("el-link",{attrs:{slot:"reference",type:"danger",size:"mini"},slot:"reference"},[e._v("移除")])],1)]}}])})],1),e._v(" "),o("el-pagination",{staticStyle:{"margin-top":"5px"},attrs:{background:"","current-page":e.searchFormData.pageIndex,"page-size":e.searchFormData.pageSize,"page-sizes":[5,10,20,40],total:e.pageInfo.total,layout:"total, sizes, prev, pager, next"},on:{"size-change":e.onSizeChange,"current-change":e.onPageIndexChange}}),e._v(" "),o("el-dialog",{attrs:{title:"添加用户","close-on-click-modal":!1,visible:e.memberAddDlgShow},on:{"update:visible":function(t){e.memberAddDlgShow=t},close:e.onHide}},[o("el-form",{ref:"memberAddForm",staticStyle:{width:"600px"},attrs:{model:e.memberAddFormData,rules:e.memberAddRules,size:"mini","label-width":"150px"}},[o("el-form-item",{attrs:{label:"用户",required:""}},[o("user-select",{ref:"userSelect",attrs:{loader:e.loadSpaceMember,multiple:""}})],1),e._v(" "),o("el-form-item",{attrs:{label:"角色",prop:"roleCode"}},[o("el-select",{model:{value:e.memberAddFormData.roleCode,callback:function(t){e.$set(e.memberAddFormData,"roleCode",t)},expression:"memberAddFormData.roleCode"}},e._l(e.roleCodeConfig,(function(t){return o("el-option",{key:t.code,attrs:{value:t.code,label:t.label}},[e._v("\n              "+e._s(t.label)+"\n            ")])})),1)],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.memberAddDlgShow=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.onMemberAddSave}},[e._v("保 存")])],1)],1)],1)},q=[],B={name:"ProjectMember",components:{UserSelect:E["a"]},props:{projectId:{type:String,default:""}},data:function(){return{searchFormData:{username:"",roleCode:"",projectId:"",pageIndex:1,pageSize:20},pageInfo:{rows:[],total:0},roleCodeConfig:[{label:"访客",code:"visitor",className:"el-icon-view"},{label:"开发者",code:"dev",className:"el-icon-s-platform"},{label:"组长",code:"leader",className:"el-icon-s-custom"}],memberAddDlgShow:!1,memberAddFormData:{roleCode:""},memberAddRules:{roleCode:[{required:!0,message:"请选择",trigger:["blur","change"]}]}}},watch:{projectId:function(e){e&&(this.searchFormData.projectId=e,this.loadTable())}},methods:{loadTable:function(){var e=this;this.get("/project/member/page",this.searchFormData,(function(t){e.pageInfo=t.data}))},onRoleChange:function(e){var t=this,o={projectId:this.projectId,userId:e.userId,roleCode:e.roleCode};this.post("/project/member/update",o,(function(){t.tipSuccess("修改成功")}))},onMemberRemove:function(e){var t=this,o={projectId:this.projectId,userId:e.userId};this.post("/project/member/remove",o,(function(e){t.tipSuccess("移除成功"),t.loadTable()}))},onMemberAdd:function(){this.memberAddDlgShow=!0},onMemberAddSave:function(){var e=this,t=this.$refs.userSelect.validate(),o=this.$refs.memberAddForm.validate();Promise.all([t,o]).then((function(t){var o=e.$refs.userSelect.getValue();Object.assign(e.memberAddFormData,{projectId:e.projectId,userIds:o}),e.post("/project/member/add",e.memberAddFormData,(function(t){e.tipSuccess("添加成功"),e.memberAddDlgShow=!1,e.loadTable()}))})).catch((function(e){}))},onSizeChange:function(e){this.searchFormData.pageSize=e,this.loadTable()},onPageIndexChange:function(e){this.searchFormData.pageIndex=e,this.loadTable()},onHide:function(){this.resetForm("memberAddForm"),this.$refs.userSelect.resetForm()}}},K=B,G=Object(f["a"])(K,U,q,!1,null,null,null),Z=G.exports,Q={components:{ProjectMember:Z,Module:J,ProjectInfo:O},data:function(){return{projectId:"",projectIdDoc:"",projectIdInfo:"",projectIdMember:"",activeName:"Doc"}},created:function(){},mounted:function(){this.projectId=this.$route.params.projectId,this.loadData(this.projectId)},methods:{handleClick:function(){this.loadData(this.projectId)},loadData:function(e){this["projectId".concat(this.activeName)]=e}}},W=Q,X=Object(f["a"])(W,a,r,!1,null,null,null);t["default"]=X.exports},cbc6:function(e,t,o){"use strict";var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"doc-baseinfo"},[o("h2",{staticStyle:{"margin-top":"0"}},[e._v(e._s(e.docInfo.name))])]),e._v(" "),o("h3",[e._v("接口描述")]),e._v(" "),o("div",{staticClass:"doc-overview"},[e._v(e._s(e.docInfo.description||e.docInfo.name))]),e._v(" "),o("h3",[e._v("请求地址")]),e._v(" "),o("span",{staticClass:"normal-text"},[o("el-tag",{attrs:{type:"info"}},[e._v(e._s(e.docInfo.httpMethod))]),e._v(" "+e._s(e.docInfo.url)+"\n  ")],1),e._v(" "),o("h3",[e._v("请求Header")]),e._v(" "),o("parameter-table",{attrs:{data:e.docInfo.headerParams,"can-add-node":!1,"hidden-columns":["type","maxLength"],"empty-text":"无Header"}}),e._v(" "),o("h3",[e._v("请求参数")]),e._v(" "),o("parameter-table",{attrs:{data:e.docInfo.requestParams}}),e._v(" "),o("h3",[e._v("响应参数")]),e._v(" "),o("parameter-table",{attrs:{data:e.docInfo.responseParams,"hidden-columns":["required","maxLength"]}}),e._v(" "),o("h3",[e._v("响应示例")]),e._v(" "),o("pre",{staticClass:"normal-text"},[e._v(e._s(JSON.stringify(e.responseSuccessExample,null,4)))]),e._v(" "),o("h3",[e._v("错误码")]),e._v(" "),o("parameter-table",{attrs:{data:e.docInfo.errorCodeParams,"empty-text":"无错误码","hidden-columns":["required","maxLength","type"],"name-label":"错误码","description-label":"错误描述","example-label":"解决方案"}})],1)},r=[],l=(o("7f7f"),o("ac6a"),function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-table",{attrs:{data:e.data,border:"","row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"},"cell-style":e.cellStyleSmall(),"header-cell-style":e.headCellStyleSmall(),"row-class-name":e.tableRowClassName,"empty-text":e.emptyText}},[e.isColumnShow("name")?o("el-table-column",{attrs:{prop:"name",label:e.nameLabel,width:"250"}}):e._e(),e._v(" "),e.isColumnShow("type")?o("el-table-column",{attrs:{prop:"type",label:"类型",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.row.type))]),e._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:"array"===t.row.type&&t.row.elementType,expression:"scope.row.type === 'array' && scope.row.elementType"}]},[o("el-tooltip",{attrs:{effect:"dark",content:"元素类型："+t.row.elementType,placement:"top"}},[o("i",{staticClass:"el-icon-info"})])],1)]}}],null,!1,2166743574)}):e._e(),e._v(" "),e.isColumnShow("required")?o("el-table-column",{attrs:{prop:"required",label:"必须",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",{class:t.row.required?"danger":""},[e._v(e._s(t.row.required?"是":"否"))])]}}],null,!1,3205898986)}):e._e(),e._v(" "),e.isColumnShow("maxLength")?o("el-table-column",{attrs:{prop:"maxLength",label:"最大长度"}}):e._e(),e._v(" "),e.isColumnShow("description")?o("el-table-column",{attrs:{prop:"description",label:e.descriptionLabel}}):e._e(),e._v(" "),e.isColumnShow("example")?o("el-table-column",{attrs:{prop:"example",label:e.exampleLabel},scopedSlots:e._u([{key:"default",fn:function(t){return["enum"===t.row.type?o("div",[e._v("\n        "+e._s((t.row.enums||[]).join("、"))+"\n      ")]):o("div",[e._v("\n        "+e._s(t.row.example)+"\n      ")])]}}],null,!1,1693832681)}):e._e()],1)}),n=[],i={name:"ParameterTable",props:{data:{type:Array,default:function(){return[]}},emptyText:{type:String,default:"无参数"},nameLabel:{type:String,default:"名称"},descriptionLabel:{type:String,default:"描述"},exampleLabel:{type:String,default:"示例值"},hiddenColumns:{type:Array,default:function(){return[]}}},methods:{tableRowClassName:function(e){var t=e.row;e.index;return t.isDeleted?(t.hidden=!0,"hidden-row"):""},isColumnShow:function(e){return 0===this.hiddenColumns.filter((function(t){return t===e})).length}}},s=i,d=o("2877"),c=Object(d["a"])(s,l,n,!1,null,null,null),m=c.exports,u={name:"DocView",components:{ParameterTable:m},props:{docId:{type:String,default:""},docInfoString:{type:String,default:"{}"}},data:function(){return{baseInfoCellStyle:function(e){return 0===e.columnIndex||2===e.columnIndex?{padding:"5px 0",background:"#f5f7fa"}:{padding:"5px 0"}},commonParams:[],commonResult:[],docBaseInfoData:[],docInfo:{docId:"",name:"",url:"",contentType:"",description:"",httpMethod:"GET",parentId:"",moduleId:"",isShow:1,headerParams:[],requestParams:[],responseParams:[],errorCodeParams:[],folders:[]},responseSuccessExample:{}}},watch:{docId:function(e){this.loadData(e)},docInfoString:function(e){var t=JSON.parse(e);this.setData(t)}},created:function(){},methods:{loadData:function(e){e&&this.get("/doc/detail",{id:e},(function(e){var t=e.data;t.requestParams=this.convertTree(t.requestParams),t.responseParams=this.convertTree(t.responseParams),this.setData(t)}))},setData:function(e){this.docInfo=e,this.createResponseExample(e)},createResponseExample:function(e){this.responseSuccessExample=this.doCreateResponseExample(e.responseParams)},doCreateResponseExample:function(e){var t=this,o={};return e.forEach((function(e){var a;if(e.children&&e.children.length>0){var r=t.doCreateResponseExample(e.children);a="Array"===e.type?[r]:r}else a=e.example;o[e.name]=a})),o}}},p=u,f=(o("60bf"),Object(d["a"])(p,a,r,!1,null,"d75b2e4a",null));t["a"]=f.exports},d03d:function(e,t,o){},ef8e:function(e,t,o){}}]);
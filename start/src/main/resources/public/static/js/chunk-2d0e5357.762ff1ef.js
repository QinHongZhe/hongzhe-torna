(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0e5357"],{9406:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{name:"Info"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-info"}),e._v(" 空间信息")]),e._v(" "),a("space-info",{attrs:{"space-id":e.spaceIdInfo}})],1),e._v(" "),a("el-tab-pane",{attrs:{name:"Member"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-user"}),e._v(" 空间成员")]),e._v(" "),a("space-member",{attrs:{"space-id":e.spaceIdMember}})],1)],1)],1)},r=[],n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",staticClass:"text-form",attrs:{model:e.form,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"空间名称"}},[e._v("\n      "+e._s(e.form.name)+"\n      "),a("el-popover",{attrs:{placement:"bottom",title:"修改名称",width:"250",trigger:"click"},on:{show:e.onPopoverShow},model:{value:e.popoverShow,callback:function(t){e.popoverShow=t},expression:"popoverShow"}},[a("el-form",{ref:"updateNameForm",attrs:{model:e.updateForm,rules:e.updateFormRules,size:"mini","label-width":"100px;"}},[a("el-form-item",{attrs:{prop:"name"}},[a("el-input",{attrs:{"show-word-limit":"",maxlength:"50"},model:{value:e.updateForm.name,callback:function(t){e.$set(e.updateForm,"name",t)},expression:"updateForm.name"}})],1)],1),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.onUpdateNameSave}},[e._v("确定")])],1),e._v(" "),a("el-button",{attrs:{slot:"reference",type:"text",icon:"el-icon-edit"},slot:"reference"})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"空间管理员"}},[e._v("\n      "+e._s(e.form.leader)+"\n    ")]),e._v(" "),a("el-form-item",{attrs:{label:"创建人"}},[e._v("\n      "+e._s(e.form.creator)+"\n    ")]),e._v(" "),a("el-form-item",{attrs:{label:"创建时间"}},[e._v("\n      "+e._s(e.form.gmtCreate)+"\n    ")]),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:e.onSpaceDel}},[e._v("删除空间")])],1)],1)],1)},s=[],l={name:"SpaceInfo",props:{spaceId:{type:String,default:""}},data:function(){return{form:{id:"",name:"",creator:"",gmtCreate:""},popoverShow:!1,updateForm:{id:"",name:""},updateFormRules:{name:[{required:!0,message:"不能为空",trigger:"blur"}]}}},watch:{spaceId:function(e){this.loadInfo(e)}},methods:{onPopoverShow:function(){Object.assign(this.updateForm,this.form)},onUpdateNameSave:function(){var e=this;this.$refs.updateNameForm.validate((function(t){t&&(e.updateForm.id=e.form.id,e.post("/space/updateName",e.updateForm,(function(){e.popoverShow=!1,location.reload()})))}))},onSpaceDel:function(){var e=this;this.confirm("确认要删除该空间吗？",(function(){e.post("/space/delete",{id:e.spaceId},(function(){e.setSpaceId(0),alert("删除成功"),location.reload()}))}))},loadInfo:function(e){var t=this;e&&this.get("/space/info",{spaceId:e},(function(e){var a=e.data,o=a.leaders.map((function(e){return e.realname}));a.leader=o.join(" / "),t.form=a}))}}},i=l,c=a("2877"),m=Object(c["a"])(i,n,s,!1,null,null,null),d=m.exports,p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchFormData,size:"mini"}},[a("el-form-item",{attrs:{label:"登录账号"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{clearable:!0,placeholder:"登录账号"},model:{value:e.searchFormData.username,callback:function(t){e.$set(e.searchFormData,"username",t)},expression:"searchFormData.username"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.loadTable}},[e._v("查询")])],1)],1),e._v(" "),a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:e.onMemberAdd}},[e._v("添加成员")]),e._v(" "),a("el-table",{attrs:{data:e.pageInfo.rows,border:"","highlight-current-row":""}},[a("el-table-column",{attrs:{prop:"username",label:"成员",width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.realname+"("+t.row.username+")")+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"gmtCreate",label:"加入时间",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popconfirm",{attrs:{title:"确定要移除 "+t.row.realname+"("+t.row.username+") 吗？"},on:{onConfirm:function(a){return e.onMemberRemove(t.row)}}},[a("el-link",{attrs:{slot:"reference",type:"danger",size:"mini"},slot:"reference"},[e._v("移除")])],1)]}}])})],1),e._v(" "),a("el-pagination",{staticStyle:{"margin-top":"5px"},attrs:{background:"","current-page":e.searchFormData.pageIndex,"page-size":e.searchFormData.pageSize,"page-sizes":[5,10,20,40],total:e.pageInfo.total,layout:"total, sizes, prev, pager, next"},on:{"size-change":e.onSizeChange,"current-change":e.onPageIndexChange}}),e._v(" "),a("el-dialog",{attrs:{title:"添加用户","close-on-click-modal":!1,visible:e.memberAddDlgShow},on:{"update:visible":function(t){e.memberAddDlgShow=t},close:e.onHide}},[a("el-form",{ref:"memberAddForm",staticStyle:{width:"600px"},attrs:{model:e.memberAddFormData,size:"mini","label-width":"150px"}},[a("el-form-item",{attrs:{label:"用户",required:""}},[a("user-select",{ref:"userSelect",attrs:{multiple:""}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.memberAddDlgShow=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.onMemberAddSave}},[e._v("保 存")])],1)],1)],1)},u=[],f=(a("ac6a"),a("5df3"),a("3944")),h={name:"SpaceMember",components:{UserSelect:f["a"]},props:{spaceId:{type:String,default:""}},data:function(){return{searchFormData:{username:"",spaceId:"",pageIndex:1,pageSize:20},pageInfo:{rows:[],total:0},memberAddDlgShow:!1,memberAddFormData:{name:"",leaderId:""}}},watch:{spaceId:function(e){e&&(this.searchFormData.spaceId=e,this.loadTable())}},methods:{loadTable:function(){var e=this;this.get("/space/member/page",this.searchFormData,(function(t){e.pageInfo=t.data}))},onMemberRemove:function(e){var t=this,a={spaceId:this.spaceId,userId:e.id};this.post("/space/member/remove",a,(function(e){t.tipSuccess("移除成功"),t.loadTable()}))},onMemberAdd:function(){this.memberAddDlgShow=!0},onMemberAddSave:function(){var e=this,t=this.$refs.userSelect.validate();Promise.all([t]).then((function(t){var a=e.$refs.userSelect.getValue(),o={spaceId:e.spaceId,userIds:a};e.post("/space/member/add",o,(function(t){e.tipSuccess("添加成功"),e.memberAddDlgShow=!1,e.loadTable()}))})).catch((function(e){}))},onSizeChange:function(e){this.searchFormData.pageSize=e,this.loadTable()},onPageIndexChange:function(e){this.searchFormData.pageIndex=e,this.loadTable()},onHide:function(){this.resetForm("memberAddForm"),this.$refs.userSelect.resetForm()}}},b=h,v=Object(c["a"])(b,p,u,!1,null,null,null),g=v.exports,S={components:{SpaceInfo:d,SpaceMember:g},data:function(){return{activeName:"Info",spaceIdInfo:"",spaceIdMember:""}},computed:{spaceId:function(){return this.$store.state.settings.spaceId}},watch:{spaceId:function(e){this.loadData(e)}},mounted:function(){this.loadData(this.spaceId)},methods:{loadData:function(e){this["spaceId".concat(this.activeName)]=e},handleClick:function(){this.loadData(this.spaceId)}}},_=S,I=Object(c["a"])(_,o,r,!1,null,null,null);t["default"]=I.exports}}]);